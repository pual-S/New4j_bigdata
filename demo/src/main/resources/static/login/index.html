<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>登录与注册</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="shortcut icon" href="../img/logo.jpg" type="text/plain">
  <script src="../js/jquery.min.js"></script>

  <script type="text/javascript">
    function codeButton_registerpage() {
      var code = $("#registerpage_code");
      code.attr("disabled", "disabled");
      setTimeout(function () {
        code.css("opacity", "0.8");
      }, 1000)
      var time = 60;
      var set = setInterval(function () {
        code.val("(" + --time + ")秒后重新获取");
      }, 1000);
      setTimeout(function () {
        code.attr("disabled", false).val("重新获取验证码");
        clearInterval(set);
      }, 60000);
    }

      $(function () {
        $("#registerpage_code").click(function () {
          $.ajax({
            type: "post",  //请求方式
            url: "/email/sendEmail",  //请求路径：页面/方法名字
            data: {"email": document.getElementById("registerpage_email").value},     //参数
            dataType: 'json',
            success: function (dat) {
              /*if (!dat.code) {
              window.onclick(popup('成功', dat.msg, 'success'))
            }else {
              window.onclick(popup('错误', dat.msg, 'info'))
            }*/
              alert(dat.msg);
            },
            error: function () {
              //window.onclick(popup('错误', '网络繁忙,发送失败.', 'info'))
              alert("网络繁忙,发送失败!");
            }
          });
        });
      });

    /*
    * 注册ajax
    * */
    function registerpage_btn() {
      $(function () {
        $("#registerpage_btn").click(function () {
          $.ajax({
            type: "post",  //请求方式
            url: "/registerpage/registerpage",  //请求路径：页面/方法名字
            data: {
              "registerpage_email": document.getElementById("registerpage_email").value,
              "registerpage_Name": document.getElementById("registerpage_Name").value,
              "registerpage_Password": document.getElementById("registerpage_Password").value,
              "registerpage_email_password": document.getElementById("registerpage_email_password").value
            },     //参数
            dataType: 'json',
            success: function (dat) {
              if (!dat.code) {
                //window.onclick(popup('成功', dat.msg, 'success'))
                alert(dat.msg)
                window.location.href = "../welcome/index.html";
              } else {
                //window.onclick(popup('错误', dat.msg, 'info'))
                alert(dat.msg)
                window.location.href = "../login/index.html";
              }
            },
            error: function () {
              //window.onclick(popup('错误', '输入格式有问题', 'info'))
              alert("输入格式有问题");
              window.location.href = "../login/index.html";
            }
          });
        });
      });
    }

    /*
    * 登录ajax
    * */
    function login_btn() {
      $(function () {
        $("#login_btn").click(function () {
          $.ajax({
            type: "post",  //请求方式
            url: "/login/login",  //请求路径：页面/方法名字
            data: {
              "login_Usernumber": document.getElementById("login_Usernumber").value,
              "login_Password": document.getElementById("login_Password").value
            },     //参数
            dataType: 'json',
            success: function (dat) {
              if (!dat.code) {
                //window.onclick(popup('成功', dat.msg, 'success'))
                alert(dat.msg)
                window.location.href = "../welcome/index.html";
              } else {
                //window.onclick(popup('错误', dat.msg, 'info'))
                alert(dat.msg)
                window.location.href = "../login/index.html";
              }
            },
            error: function () {
              //window.onclick(popup('错误', '1.输入格式有问题 2.账号已经被管理员封禁', 'info'))
              alert("1.输入格式有问题 2.账号已经被管理员封禁");
              window.location.href = "../login/index.html";
            }
          });
        });
      });
    }
  </script>
</head>
<body>
<!-- partial:index.partial.html -->
<div class="container">
  <div class="box"></div>
  <div class="container-forms">
    <div class="container-info">
      <div class="info-item">
        <div class="table">
          <div class="table-cell">
            <p>
              已经有账号了？
            </p>
            <div class="btn">
             登录
            </div>
          </div>
        </div>
      </div>
      <div class="info-item">
        <div class="table">
          <div class="table-cell">
            <p>
              还没有账号？
            </p>
            <div class="btn">
              注册
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container-form">
      <div class="form-item log-in">
        <div class="table">
          <div class="table-cell">
            <input name="login_Usernumber" placeholder="邮箱的除去@后面的数字" type="text" id="login_Usernumber" maxlength="" />
            <input name="login_Password" placeholder="密码" type="Password" id="login_Password" maxlength="6" minlength="6"/>
            <div class="btn" id="login_btn" onclick="login_btn()">
              登录
            </div>
          </div>
        </div>
      </div>
      <div class="form-item sign-up">
        <div class="table">
          <div class="table-cell">
            <input name="registerpage_email" placeholder="邮箱(支持所有邮箱)" type="text" id="registerpage_email" maxlength="24" minlength="11"/>
            <input name="registerpage_Name" placeholder="姓名" type="text" id="registerpage_Name"/>
            <input name="registerpage_Password" placeholder="密码(6位)" type="Password" id="registerpage_Password" maxlength="6" minlength="6"/>
            <input name="registerpage_email_password" placeholder="邮箱验证码" type="text" id="registerpage_email_password" maxlength="6" minlength="6"/>
            <input name="registerpage_email_key" placeholder="获取验证码" type="button" id="registerpage_code" onclick="codeButton_registerpage()" value="获取邮箱验证码">
            <div class="btn" id="registerpage_btn" onclick="registerpage_btn()">
             注册
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script  src='../js/jquery-2.2.4.min.js'></script>
<script  src="../js/script.js"></script>
</body>
</html>
